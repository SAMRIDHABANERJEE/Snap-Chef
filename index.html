<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SnapChef | Reduce Waste, Eat Well</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
    
    <style>
        /* --- CUSTOM THEME SETUP --- */
        :root {
            --primary-green: #059669;
            --cream-bg: #FAFAF9;
            --dark-text: #1C1917;
        }
        body {
            background-color: var(--cream-bg);
            font-family: 'DM Sans', sans-serif;
            color: var(--dark-text);
        }
        h1, h2, h3, h4 {
            font-family: 'Playfair Display', serif;
        }
        
        /* Animation: Fade In Up */
        .fade-in {
            animation: fadeInUp 0.8s ease-out forwards;
            opacity: 0;
            transform: translateY(20px);
        }
        @keyframes fadeInUp {
            to { opacity: 1; transform: translateY(0); }
        }

        /* Animation: Scanning Line */
        .scanning-line {
            width: 100%;
            height: 3px;
            background: #10B981;
            position: absolute;
            top: 0;
            left: 0;
            animation: scan 2s infinite linear;
            box-shadow: 0 0 10px #10B981;
            z-index: 50;
        }
        @keyframes scan {
            0% { top: 0%; opacity: 0; }
            20% { opacity: 1; }
            80% { opacity: 1; }
            100% { top: 100%; opacity: 0; }
        }

        /* Utility: Hide Scrollbar */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="min-h-screen flex flex-col selection:bg-emerald-200">

    <!-- NAVIGATION -->
    <nav class="w-full px-6 py-4 flex justify-between items-center bg-white/80 backdrop-blur-md sticky top-0 z-40 border-b border-stone-200">
        <div class="flex items-center gap-2 text-emerald-700">
            <!-- Icon -->
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
            <span class="text-xl font-bold tracking-tight">SnapChef</span>
        </div>
        <div class="hidden md:block text-sm font-medium text-stone-500">Eco-Kitchen Intelligence</div>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="flex-grow container mx-auto px-4 py-10 max-w-4xl">
        
        <!-- Header -->
        <header class="text-center mb-10">
            <h1 class="text-4xl md:text-6xl font-bold mb-4 text-emerald-900 leading-tight">Don't waste it. <br><span class="text-emerald-600">Taste it.</span></h1>
            <p class="text-lg text-stone-600 max-w-xl mx-auto">Upload a photo of your fridge. Our AI identifies ingredients, prioritizes what's expiring, and creates recipes instantly.</p>
        </header>

        <!-- UPLOAD SECTION (FIXED FOR GITHUB PAGES) -->
        <!-- We use an onclick handler on the div to trigger the hidden input -->
        <div id="upload-container" onclick="triggerUpload()" class="bg-white rounded-3xl shadow-xl border-2 border-dashed border-stone-300 p-12 text-center hover:border-emerald-500 hover:shadow-2xl transition-all cursor-pointer relative overflow-hidden group">
            
            <!-- The actual input is hidden. We trigger it via JS -->
            <input type="file" id="file-input" class="hidden" accept="image/*">
            
            <!-- UI State: Default -->
            <div id="upload-ui" class="group-hover:scale-105 transition-transform duration-300 pointer-events-none">
                <div class="bg-emerald-50 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-5 text-emerald-600 border border-emerald-100 shadow-sm">
                    <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                </div>
                <h3 class="text-2xl font-semibold text-stone-800">Upload Fridge Photo</h3>
                <p class="text-stone-500 mt-2 font-medium">Tap to browse or drag & drop</p>
            </div>

            <!-- UI State: Scanning (Hidden Initially) -->
            <div id="preview-container" class="hidden absolute inset-0 bg-stone-900 z-20 pointer-events-none">
                <!-- The User's Image -->
                <img id="preview-image" src="" class="w-full h-full object-cover opacity-50" alt="Fridge Content">
                
                <!-- Scanning Animation Layers -->
                <div class="absolute inset-0 flex flex-col items-center justify-center z-30">
                    <div class="scanning-line" id="scan-line"></div>
                    <div id="scan-text" class="bg-black/60 backdrop-blur-md px-6 py-3 rounded-full text-white font-medium animate-pulse border border-white/10 shadow-lg">
                        Identifying Ingredients...
                    </div>
                </div>
            </div>
        </div>

        <!-- RESULTS SECTION -->
        <div id="results-section" class="hidden mt-16">
            
            <!-- AI Logic Box -->
            <div class="fade-in bg-gradient-to-r from-emerald-50 to-white border border-emerald-100 p-6 rounded-2xl mb-10 flex flex-col md:flex-row items-start gap-4 shadow-sm">
                <div class="bg-emerald-100 p-2 rounded-lg text-emerald-700 mt-1 shrink-0">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                </div>
                <div>
                    <h3 class="font-bold text-emerald-900 text-lg mb-2">Analysis Complete</h3>
                    <p class="text-emerald-800 leading-relaxed mb-3" id="ai-reasoning-text">
                        <!-- JS fills this -->
                    </p>
                    <div class="flex flex-wrap gap-2" id="detected-tags">
                        <!-- JS fills this -->
                    </div>
                </div>
            </div>

            <div class="fade-in flex items-end justify-between mb-6 border-b border-stone-200 pb-2">
                <h2 class="text-3xl font-bold text-stone-800">Generated Recipes</h2>
                <span class="text-xs font-bold uppercase tracking-wider text-emerald-600 bg-emerald-50 px-3 py-1 rounded-full">3 Options Found</span>
            </div>

            <!-- Cards Grid -->
            <div class="fade-in grid md:grid-cols-3 gap-8" id="recipe-grid">
                <!-- JS fills this -->
            </div>
        </div>

    </main>

    <!-- FOOTER -->
    <footer class="text-center py-8 text-stone-400 text-sm border-t border-stone-200 mt-10">
        &copy; 2024 SnapChef Demo. No images are actually uploaded to a server (Privacy First).
    </footer>

    <!-- RECIPE MODAL OVERLAY -->
    <div id="recipe-modal" class="fixed inset-0 z-[60] hidden">
        <!-- Backdrop -->
        <div class="absolute inset-0 bg-stone-900/60 backdrop-blur-sm transition-opacity duration-300" onclick="closeModal()"></div>
        
        <!-- Modal Card -->
        <div class="absolute inset-x-0 bottom-0 md:inset-0 md:flex md:items-center md:justify-center pointer-events-none">
            <div id="modal-card" class="bg-white w-full md:w-[650px] md:h-[85vh] h-[90vh] md:rounded-2xl rounded-t-2xl shadow-2xl pointer-events-auto flex flex-col overflow-hidden transform transition-all duration-300 translate-y-full md:translate-y-10 opacity-0">
                
                <!-- Modal Image Header -->
                <div class="h-56 bg-emerald-600 relative shrink-0">
                    <img id="modal-img" src="" class="w-full h-full object-cover">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"></div>
                    
                    <!-- Close Button -->
                    <button onclick="closeModal()" class="absolute top-4 right-4 bg-black/20 hover:bg-black/40 backdrop-blur-md text-white rounded-full p-2 transition border border-white/20">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                    </button>
                    
                    <!-- Title Overlay -->
                    <div class="absolute bottom-5 left-6 text-white right-6">
                        <span id="modal-badge" class="text-xs font-bold uppercase tracking-wider bg-emerald-500 px-2 py-1 rounded mb-2 inline-block shadow-sm">Category</span>
                        <h2 id="modal-title" class="text-3xl md:text-4xl font-serif font-bold leading-tight mt-1">Recipe Title</h2>
                    </div>
                </div>

                <!-- Modal Scrollable Content -->
                <div class="p-8 overflow-y-auto no-scrollbar flex-grow bg-white">
                    
                    <!-- Stats -->
                    <div class="flex gap-8 mb-8 border-b border-stone-100 pb-6">
                        <div>
                            <span class="block text-2xl font-bold text-stone-800" id="modal-time">20m</span>
                            <span class="text-xs text-stone-500 uppercase tracking-wide font-semibold">Total Time</span>
                        </div>
                        <div>
                            <span class="block text-2xl font-bold text-stone-800" id="modal-cal">450</span>
                            <span class="text-xs text-stone-500 uppercase tracking-wide font-semibold">Calories</span>
                        </div>
                    </div>

                    <!-- Ingredients -->
                    <div class="mb-8">
                        <h4 class="font-bold text-lg mb-3 text-stone-800 flex items-center gap-2">
                            <svg class="w-5 h-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg>
                            Shopping List (Missing Items)
                        </h4>
                        <ul id="modal-missing" class="bg-stone-50 p-4 rounded-xl space-y-2 text-stone-700 border border-stone-200">
                            <!-- JS Injected -->
                        </ul>
                    </div>

                    <!-- Steps -->
                    <div>
                        <h4 class="font-bold text-lg mb-3 text-stone-800 flex items-center gap-2">
                            <svg class="w-5 h-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg>
                            Instructions
                        </h4>
                        <ol id="modal-steps" class="space-y-6 relative border-l-2 border-stone-200 ml-3 pl-6">
                            <!-- JS Injected -->
                        </ol>
                    </div>
                </div>

                <!-- Modal Sticky Footer -->
                <div class="p-5 bg-white border-t border-stone-200 shrink-0">
                    <button class="w-full bg-emerald-800 hover:bg-emerald-900 text-white font-bold py-4 rounded-xl transition shadow-lg flex justify-center items-center gap-2 text-lg" onclick="closeModal()">
                        Start Cooking
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- MOCK DATA (Simulating Backend Response) ---
        const mockDetectedIngredients = ["Spinach (Wilting)", "Tomatoes", "Eggs", "Half Onion", "Cheddar Cheese"];
        
        const recipes = [
            {
                id: 1,
                type: "Quick Snack",
                title: "Spinach & Tomato Frittata",
                desc: "A protein-packed snack ready in 10 minutes. Perfect for using up those eggs.",
                time: "10 mins",
                cals: "220",
                image: "https://images.unsplash.com/photo-1590233634125-961d67015893?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80",
                missing: ["Olive Oil", "Salt & Pepper"],
                steps: [
                    "Whisk eggs with a splash of water, salt, and pepper.",
                    "Sauté onions and tomatoes in olive oil until soft.",
                    "Add spinach and cook until wilted (save it!).",
                    "Pour eggs over veggies, sprinkle cheese, and cover until set."
                ],
                reason: "Good Match",
                freshnessNote: "Uses your eggs and tomatoes efficiently."
            },
            {
                id: 2,
                type: "Healthy Dinner",
                title: "Warm Spinach & Egg Salad",
                desc: "Warm salad with caramelized onions and soft boiled egg.",
                time: "25 mins",
                cals: "340",
                image: "https://images.unsplash.com/photo-1533089862017-ec329abb0933?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80",
                missing: ["Balsamic Vinegar", "Dijon Mustard", "Walnuts"],
                steps: [
                    "Boil the eggs to your preference (soft boiled is best).",
                    "Caramelize onions slowly in a pan.",
                    "Make a dressing with vinegar and mustard.",
                    "Toss spinach in the warm pan for 30 seconds to revive it.",
                    "Top with sliced egg and walnuts."
                ],
                reason: "Best Choice", // Logic flag
                freshnessNote: "CRITICAL: Your spinach is wilting! The heat in this recipe masks the texture while keeping nutrients."
            },
            {
                id: 3,
                type: "Gourmet Challenge",
                title: "Classic Shakshuka",
                desc: "A rich tomato base with poached eggs and spices.",
                time: "45 mins",
                cals: "510",
                image: "https://images.unsplash.com/photo-1590412200988-a436970781fa?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80",
                missing: ["Cumin", "Paprika", "Garlic", "Crusty Bread"],
                steps: [
                    "Dice onions and sauté with garlic.",
                    "Add chopped tomatoes and spices (cumin, paprika). Simmer for 20 mins.",
                    "Stir in spinach.",
                    "Create wells in sauce and crack eggs into them.",
                    "Cover and simmer until whites are set.",
                    "Serve with crusty bread."
                ],
                reason: "Advanced",
                freshnessNote: "Excellent use of ripe tomatoes."
            }
        ];

        // --- DOM ELEMENT REFERENCES ---
        const fileInput = document.getElementById('file-input');
        const uploadUI = document.getElementById('upload-ui');
        const previewContainer = document.getElementById('preview-container');
        const previewImage = document.getElementById('preview-image');
        const scanLine = document.getElementById('scan-line');
        const scanText = document.getElementById('scan-text');
        
        const resultsSection = document.getElementById('results-section');
        const recipeGrid = document.getElementById('recipe-grid');
        const aiReasoningText = document.getElementById('ai-reasoning-text');
        const detectedTags = document.getElementById('detected-tags');
        
        // Modal references
        const modal = document.getElementById('recipe-modal');
        const modalCard = document.getElementById('modal-card');
        const modalTitle = document.getElementById('modal-title');
        const modalImg = document.getElementById('modal-img');
        const modalBadge = document.getElementById('modal-badge');
        const modalTime = document.getElementById('modal-time');
        const modalCal = document.getElementById('modal-cal');
        const modalMissing = document.getElementById('modal-missing');
        const modalSteps = document.getElementById('modal-steps');

        // --- CORE FUNCTIONS ---

        /** 
         * 1. TRIGGER UPLOAD 
         * This forces the hidden file input to open when the div is clicked.
         * Crucial for UI styling.
         */
        function triggerUpload() {
            fileInput.click();
        }

        /**
         * 2. HANDLE FILE SELECTION
         * Detects file, reads it locally (FileReader), and starts simulation.
         */
        fileInput.addEventListener('change', function(e) {
            if (this.files && this.files[0]) {
                const file = this.files[0];
                
                // Read the file locally to show preview
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImage.src = e.target.result;
                    
                    // Show scanning UI
                    uploadUI.classList.add('hidden');
                    previewContainer.classList.remove('hidden');
                    
                    // Begin AI Simulation
                    simulateAnalysis();
                }
                reader.readAsDataURL(file);
            }
        });

        /**
         * 3. SIMULATE AI ANALYSIS
         * Fakes a 2.5s delay then renders results.
         */
        function simulateAnalysis() {
            // Scroll user slightly down to indicate activity
            window.scrollTo({ top: 150, behavior: 'smooth' });

            setTimeout(() => {
                // Stop Animation UI
                scanLine.style.display = 'none';
                scanText.innerText = "Scan Complete";
                scanText.classList.remove('animate-pulse');
                scanText.classList.add('bg-emerald-600');

                // Render Data
                renderResults();
            }, 2500);
        }

        /**
         * 4. RENDER RESULTS
         * Injects HTML for reasoning and recipe cards.
         */
        function renderResults() {
            resultsSection.classList.remove('hidden');
            
            // 1. Fill Reasoning Text
            aiReasoningText.innerHTML = `I've analyzed your upload. <strong class="text-emerald-700">The spinach appears to be wilting (approx 2 days left)</strong>, so I've prioritized recipes that use it immediately. Your tomatoes and eggs are in prime condition.`;

            // 2. Fill Tags
            detectedTags.innerHTML = mockDetectedIngredients.map(tag => 
                `<span class="bg-white border border-stone-200 text-stone-600 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider sha
               
